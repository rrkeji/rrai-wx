<!--pages/chat/chat.wxml-->
<view class="news" bindtap='outbtn'>
  <!-- <view class="chat-notice">说出您想知道的?</view> -->
  <view class="historycon">
    <scroll-view scroll-y="true" class="history" scroll-top="{{scrollTop}}">
      <block wx:for="{{newslist}}" wx:key="item">
        <!--send  -->
        <view class="chat-news request" wx:if="{{item.sender == 'client'}}">
          <view class='news-content'>
            <block wx:if="{{item.type=='text'}}">
              <view class='new_txt request-text'>{{item.text}}</view>
            </block>
            <block wx:if="{{item.type=='image'}}">
              <image class="selectImg" src="{{item.images}}" data-src="{{item.images}}" lazy-load="true" bindtap="previewImg"></image>
            </block>
          </view>
          <view class="news-avatar">
            <image class='avatar' src="./images/logo.png"></image>
            <!-- <text class="name">您</text> -->
          </view>
        </view>
        <!-- AI  -->
        <view class="chat-news response" wx:else>
          <view class="news-avatar">
            <image class='avatar' src="./images/logo.png"></image>
            <!-- <text class="name">软软</text> -->
          </view>
          <view class='news-content'>
            <block wx:if="{{item.type=='text'}}">
              <view class='response-content new_txt ' style="white-space: pre-wrap">{{item.text}}</view>
            </block>
            <block wx:if="{{item.type=='richtext'}}">
              <view class='response-content new_rich_txt '>
                <rich-text nodes="{{item.content}}"></rich-text>
              </view>
            </block>
            <block wx:if="{{item.type=='image'}}">
              <view class='response-content new_image'>
                <image src="{{item.url}}" data-src="{{item.url}}"></image>
              </view>
            </block>
            <block wx:if="{{item.type=='voice'}}">
            </block>
            <block wx:if="{{item.type=='video'}}">
            </block>
            <block wx:if="{{item.type=='shortvideo'}}">
            </block>
            <block wx:if="{{item.type=='location'}}">
            </block>
            <block wx:if="{{item.type=='link'}}">
              <view class='response-content new_link' bindtap='linkGoTo' data-url="{{item.url}}">
                <view>
                  <image class='new-link-pic' src="{{item.thumbPicUrl}}" data-src="{{item.thumbPicUrl}}">
                  </image>
                  <view class='new-link-title'>{{item.title}}</view>
                </view>
                <view class='new-link-description'>{{item.description}}</view>
              </view>
            </block>
          </view>
        </view>
      </block>
      <block wx:if="{{sendLoading}}">
        <view class="chat-news response">
          <view class="news-avatar">
            <image class='avatar' src="./images/logo.png"></image>
            <!-- <text class="name">软软</text> -->
          </view>
          <view class='news-content'>
            <view class='response-content new_txt loading'>软软正在努力的思考中<image class="send-button-inner" src="./images/bars.svg"></image></view>
          </view>
        </view>
      </block>
      <block wx:if="{{newslist.length <= 0}}">
        <view class="empty-message">输入类似"写一篇200字的描写杨树的短文"试试</view>
      </block>
    </scroll-view>
  </view>
</view>
<!-- 聊天输入 -->
<view class="message">
  <view class="tipBox">
    <view class="left">
      <view class="times" bindtap="timesOnTap">{{times}}</view>
    </view>
    <view class="right">
      <view class="tipMessage">次数通过分享等增加，下面询问不占用次数：</view>

      <view class="tipItems">
        <block wx:for="{{links}}" wx:key>
          <view class="tipItem" bindtap='quickSend' data-msg="{{item.message}}">{{item.label}}</view>
        </block>
        <block wx:if="{{links.length <= 0}}">
          <view class="tipItem" bindtap='quickSend' data-msg="黄历">今日黄历</view>
          <view class="tipItem" bindtap='quickSend' data-msg="随机头像">随机头像</view>
        </block>
      </view>
    </view>
  </view>
  <form bindreset="cleanInput">
    <view class="sendMessage">
      <!-- <view class="item button" bindtap='increase'>+</view> -->
      <input class="item input" disabled="{{sendLoading}}" confirm-type="send" type="text" placeholder="请输入聊天内容..." value="{{massage}}" bindinput='bindChange' bindconfirm="bindConfirm"></input>
      <button form-type="reset" bindtap='send' class="item">
        <view class="item button send-button">
          <image class="send-button-inner" src="./images/send.svg"></image>
        </view>
      </button>
    </view>
  </form>
</view>