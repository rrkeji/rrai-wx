<!--pages/chat/chat.wxml-->
<view class="news" bindtap='outbtn'>
  <!-- <view class="chat-notice">说出您想知道的?</view> -->
  <view class="historycon">
    <scroll-view enable-flex scroll-y="true" class="history" scroll-top="{{scrollTop}}">
      <block wx:for="{{newslist}}" wx:key="item">
        <!--send  -->
        <view class="chat-news request" wx:if="{{item.sender == 'client'}}">
          <view class='news-content'>
            <view class='request-content'>
              <message-box sender="true" type="{{item.type}}" text="{{item.text}}" content="{{item.content}}" url="{{item.url}}" thumbPicUrl="{{item.thumbPicUrl}}" title="{{item.title}}" description="{{item.description}}"></message-box>
            </view>
          </view>
          <view class="news-avatar">
            <image class='avatar' src="./images/logo.png"></image>
          </view>
        </view>
        <!-- AI  -->
        <view class="chat-news response" wx:else>
          <view class="news-avatar">
            <image class='avatar' src="./images/logo.png"></image>
          </view>
          <view class='news-content'>
            <view class='response-content'>
              <message-box type="{{item.type}}" text="{{item.text}}" content="{{item.content}}" url="{{item.url}}" thumbPicUrl="{{item.thumbPicUrl}}" title="{{item.title}}" description="{{item.description}}"></message-box>
              <view class='actions-bar'>
                <!-- <view class='actions-bar-button' bindtap="onNewsCopyImage">
                  复制图片
                </view> -->
                <block wx:if="{{item.type=='text'}}">
                  <view class='actions-bar-button'>
                    <button plain="true" bindtap="onNewsCopyText" data-text="{{item.text}}">
                      复制
                    </button>
                  </view>
                </block>
                <block wx:if="{{item.msg_id > 0}}">
                  <view class='actions-bar-button'>
                    <button plain="true" open-type="share" bindtap="onNewsShareImage" data-msgId="{{item.msg_id}}">
                      分享
                    </button>
                  </view>
                </block>
              </view>
            </view>
          </view>
        </view>
      </block>
      <block wx:if="{{sendLoading}}">
        <view class="chat-news response">
          <view class="news-avatar">
            <image class='avatar' src="./images/logo.png"></image>
            <!-- <text class="name">软软</text> -->
          </view>
          <block wx:if="{{currentMessage == ''}}">
            <view class='news-content'>
              <view class='response-content new_txt loading1'>软软正在努力的思考中<image class="send-button-inner" src="./images/bars.svg"></image>
              </view>
            </view>
          </block>
          <block wx:if="{{currentMessage != ''}}">
            <view class='news-content'>
              <view class='response-content new_txt loading'>
                {{currentMessage}}<i class="loading-blink">🖋</i>
              </view>
            </view>
          </block>
        </view>
      </block>
      <block wx:if="{{newslist.length <= 0}}">
        <view class="empty-message">输入类似"写一篇200字的描写杨树的短文"试试</view>
      </block>
    </scroll-view>
  </view>
</view>
<!-- 聊天输入 -->
<view class="message">
  <view class="tipBox">
    <view class="left">
      <view class="times" bindtap="timesOnTap">{{times}}</view>
    </view>
    <view class="right">
      <view class="tipMessage">次数通过分享等增加.(有效分享才可以,有效是分享的链接有好友进入小程序.)</view>

      <view class="tipItems">
        <!-- <block wx:for="{{links}}" wx:key>
          <view class="tipItem" bindtap='quickSend' data-msg="{{item.message}}">{{item.label}}</view>
        </block> -->
        <!-- <block wx:if="{{links.length <= 0}}">
          <view class="tipItem" bindtap='quickSend' data-msg="黄历">今日黄历</view>
          <view class="tipItem" bindtap='quickSend' data-msg="随机头像">随机头像</view>
        </block> -->
      </view>
    </view>
  </view>
  <form bindreset="cleanInput">
    <view class="sendMessage">
      <!-- <view class="item button" bindtap='increase'>+</view> -->
      <input class="item input" disabled="{{sendLoading}}" confirm-type="send" type="text" placeholder="请输入聊天内容..." value="{{massage}}" bindinput='bindChange' bindconfirm="bindConfirm"></input>
      <button form-type="reset" bindtap='send' class="item">
        <view class="item button send-button">
          <image class="send-button-inner" src="./images/send.svg"></image>
        </view>
      </button>
    </view>
  </form>
</view>